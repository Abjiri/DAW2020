doctype html
html
  head
    title Students Management (DAW2020)
    link(rel='stylesheet', href='/stylesheets/style.css')
  body
    block content

    if subpage=='students'
      .w3-card-4
        header.w3-container.w3-teal
          h3.w3-left Students List (DAW2020)
        a(href=`/students/register`)
          button(class="w3-btn w3-blue-grey" type="button" style="margin: 20px") New student
        if list.length > 0
          .w3-container 
            table.w3-table-all
              tr 
                th Number
                th Name
                th Git
                th 
              each s in list
                tr
                  td 
                    a(href=`/students/${s.number}`) #{s.number}
                  td= s.name
                  td= s.git
                  td
                    div(style="display: inline-block")
                      a(href=`/students/edit/${s.number}` style="float: left; margin-right: 10px")
                        button(class="w3-btn w3-blue-grey" type="button") Edit
                      form(method="POST" action=`/students/${s.number}?_method=DELETE` style="float: left")
                        button(class="w3-btn w3-blue-grey" type="submit") Remove
        else
          .w3-container
            p There are no students...
        footer.w3-container.w3-teal
          address Generated by tp7App :: 2020-Nov, Hugo Cardoso (A85006)

    if subpage=='student'
      .w3-card-4
        header.w3-container.w3-teal
          h3.w3-left Student #{student.number} (DAW2020)
        div(style="display: block-inline")
          if student.photo != null
            img(
              src= student.photo,
              alt= "Student's photography",
              style= "margin: 20px 0px 10px 20px; height: 250px"
            )
          ul(style='list-style-type:none')
            li(style="margin-top: 10px; margin-bottom: 10px")
              b Name: 
              | #{student.name}
            li(style="margin-top: 10px; margin-bottom: 10px")
              b Git: 
              | #{student.git}
            li(style="margin-top: 10px; margin-bottom: 10px")
              b TPC: 
              | 
              table(style="margin-left: 20px")
                tr
                  each val in ['1','2','3','4','5','6','7','8']
                    th(style="padding:0 15px 0 15px") #{val}
                tr
                  each val in student.tpc
                    if val == 1
                      td(style="padding:0 15px 0 15px") ✅
                    else
                      td(style="padding:0 15px 0 15px") ❌
        a(href=`/students/edit/${student.number}` style="float: left; margin-right: 10px")
          button(class="w3-btn w3-blue-grey" type="button" style="margin: 20px 5px 20px 40px") Edit
        a(href='/students')
          button(class="w3-btn w3-blue-grey" type="button" style="margin: 20px 0px 20px 0px") Back
        
        footer.w3-container.w3-teal
          address Generated by tp7App :: 2020-Nov, Hugo Cardoso (A85006)

    if subpage=='register'
      .w3-card-4
        header.w3-container.w3-teal
          h3.w3-left New student
          
        form(
          class="w3-container" 
          action="/students" 
          method="POST" 
          style="margin-bottom: 30px; margin-top: 10px"
          enctype="multipart/form-data"
        )
          label(class="w3-text-teal")
            b Student Number:
          input(
            class="w3-input w3-border w3-light-grey" 
            style="margin-bottom: 10px" 
            type="text" 
            name="number" 
            placeholder="Axxxxx or PGxxxxx" 
            pattern="(A|PG)[1-9][0-9]{4}"
            required
          )

          label(class="w3-text-teal") 
            b Name:
          input(class="w3-input w3-border w3-light-grey" type="text" name="name" style="margin-bottom: 10px" required)

          label(class="w3-text-teal") 
            b Git:
          input(class="w3-input w3-border w3-light-grey" type="url" name="git" style="margin-bottom: 10px" required)

          table
            tr
              th
                label(class="w3-text-teal" name="tps") 
                  b TPC:
              th
                label(class="w3-text-teal" name="photo" style="margin-left: 150px") 
                  b Foto de aluno:
            tr
              td
                div.form-group(name="tps")
                  each val in ['1','2','3','4','5','6','7','8']
                    div.checkbox-inline
                      label(for=`tpc${val}`)=val
                        input.checkbox-input(type='checkbox', name=`tpc${val}`, value=checked, id=`tpc${val}`, style="margin-left: 10px")
              td
                input(type="file" name="photo" style="margin-left: 250px")


          div(id="buttons" style="margin-top: 20px; margin-bottom: 20px")
            input(class="w3-btn w3-blue-grey" style="margin-right: 15px" type="submit" value="Register")
            input(class="w3-btn w3-blue-grey" style="margin-right: 15px" type="reset" value="Clear")
            a(href='/students')
              button(class="w3-btn w3-blue-grey" type="button") Back
    
    if subpage=='edit'
      .w3-card-4
        header.w3-container.w3-teal
          h3.w3-left Edit student
          
        form(
          class="w3-container" 
          method="POST" 
          action=`/students/${student.number}?_method=PUT` 
          style="margin-bottom: 30px; margin-top: 10px"
          enctype="multipart/form-data"
        )
          input(name="id" value=student.number hidden)
          input(name="photo" value=student.photo hidden)

          label(class="w3-text-teal")
            b Student Number:
          input(
            class="w3-input w3-border w3-light-grey" 
            style="margin-bottom: 10px"
            type="text" 
            name="number" 
            value= student.number
            placeholder="Axxxxx ou PGxxxxx" 
            pattern="(A|PG)[1-9][0-9]{4}"
            required
          )

          label(class="w3-text-teal") 
            b Name:
          input(
            class="w3-input w3-border w3-light-grey" 
            style="margin-bottom: 10px"
            type="text" 
            name="name"
            value= student.name
            required
          )

          label(class="w3-text-teal") 
            b Git:
          input(
            class="w3-input w3-border w3-light-grey" 
            style="margin-bottom: 10px" 
            type="url" 
            name="git" 
            value= student.git
            required
          )

          table
            tr
              th
                label(class="w3-text-teal" name="tps" style="float: left; margin-right: 150px") 
                  b TPC:
              th
                label(class="w3-text-teal" name="photo" style="float: left") 
                  b Photography:
            tr
              td
                div.form-group(name="tps" style="margin-right: 250px")
                  each val in ['1','2','3','4','5','6','7','8']
                    div.checkbox-inline
                      label(for=`tpc${val}` style="margin-left: 10px")=val
                        input.checkbox-input(
                          type='checkbox'
                          name=`tpc${val}`
                          value=checked
                          checked= student.tpc[parseInt(val)-1] == 1
                          id=`tpc${val}`
                          style="margin-left: 10px"
                        )
              td
                if student.photo != null
                  img(
                    src= student.photo,
                    alt= "Student's photography",
                    style= "margin: 20px 0px 10px 0px; height: 250px"
                  )
                input(type="file" name="new_photo" style="margin-left: 20px")

          div(id="buttons" style="margin-top: 20px; margin-bottom: 20px")
            input(class="w3-btn w3-blue-grey" style="margin-right: 15px" type="submit" value="Submit")
            a(href=`/students/${student.number}`)
              button(class="w3-btn w3-blue-grey" type="button") Back

    if subpage=='error'
      h1= message
      h2= error.status
      pre #{error.stack}